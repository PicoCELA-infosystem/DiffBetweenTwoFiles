<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSV Comparison Tool - User Manual</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="container">
        <h1>CSV Comparison Tool - User Manual</h1>

        <h2>1. Introduction</h2>
        <p>This tool compares two CSV files line by line to analyze which rows have been added, deleted, or are duplicated within a file.</p>
        <p>This manual explains the procedure for preparing "CSV files for comparison" from the original Excel files and how to operate the web tool.</p>

        <hr>

        <h2>2. Step 1: Preparing CSV Files for Comparison (Excel Work)</h2>
        <p>This tool assumes that each row of data is unique for comparison. However, in some cases, like the "Contract Management ID" in the original Excel file, a single column may contain duplicate data, making comparison impossible.</p>
        <p>Therefore, you first need to combine multiple columns in Excel to create a <strong>"unique key" for comparison</strong>.</p>

        <h3>2.1. Creating a Unique Key</h3>
        <ol>
            <li>Open the Excel file you want to compare (e.g., `Test-Before.xlsx`).</li>
            <li>In a new sheet (Sheet2), enter a header name like "Unique Key" in the first row of a column (e.g., column A).</li>
            <li>In the second-row cell, enter a formula to concatenate the columns you want to make unique.
                <ul>
                    <li>Example: To combine "Contract Management ID" from column `A` and "Amount for 2025-08" from column `AG` of Sheet1.</li>
                    <li><strong>Formula: `=Sheet1!A2&"+"&Sheet1!AG2`</strong></li>
                    <li>This formula combines `2003990` and `13125` into a single string `2003990+13125`.</li>
                </ul>
                <img src="images/2025-09-25_19h32_21.png" alt="Excel formula input example" style="width:100%; max-width:600px; margin-top:10px;">
            </li>
            <li>Double-click the fill handle (the small square at the bottom-right corner) of the cell with the formula to copy it down to the last row.
                <img src="images/2025-09-25_19h30_55.png" alt="Completed unique key column example" style="width:100%; max-width:600px; margin-top:10px;">
            </li>
        </ol>

        <h3>2.2. Saving as a CSV File</h3>
        <ol>
            <li>With only the new sheet containing the "Unique Key" column visible, go to `File` > `Save As`.</li>
            <li>For the file type, select <strong>"CSV UTF-8 (Comma delimited) (*.csv)"</strong> and save it with a name like `File_A.csv`.
                <img src="images/2025-09-25_19h40_19.png" alt="Save as CSV example" style="width:100%; max-width:600px; margin-top:10px;">
            </li>
            <li><strong>Repeat steps 2.1 and 2.2 for the other Excel file you want to compare (e.g., `Test-After.xlsx`) to create `File_B.csv`.</strong></li>
        </ol>

        <h3>2.3. Ensure Header is on the First Line</h3>
        <ol>
            <li>The tool identifies the first line as a header. Open the saved `File_A.csv` and `File_B.csv` to ensure the header is on the first line and data starts from the second line.</li>
        </ol>
        <img src="images/2025-09-25_19h42_25.png" alt="CSV File A example" style="width:48%; max-width:300px;">
        <img src="images/2025-09-25_19h43_26.png" alt="CSV File B example" style="width:48%; max-width:300px;">

        <hr>

        <h2>3. Step 2: Comparison with the Web Tool</h2>
        <p>Once you have prepared the two CSV files for comparison, you can run the comparison with the web tool.</p>

        <h3>3.1. File Selection</h3>
        <ol>
            <li>Click the <strong>"Select File"</strong> button in the "File A" area and choose the `File_A.csv` you just created.</li>
            <li>Similarly, choose `File_B.csv` in the "File B" area.
                <img src="images/2025-09-25_19h44_56.png" alt="File selection screen example" style="width:100%; max-width:600px; margin-top:10px;">
            </li>
        </ol>

        <h3>3.2. Executing the Comparison</h3>
        <p>After selecting both files, click the blue <strong>"Compare"</strong> button.</p>

        <h3>3.3. Checking the Results and Downloading</h3>
        <ol>
            <li><strong>Summary Display</strong>: Once the processing is complete, a summary of the analysis results will be displayed on the screen.</li>
            <li><strong>ZIP Download</strong>: Simultaneously, a ZIP file (`analysis_results.zip`) containing the detailed analysis results will be automatically downloaded.
                <img src="images/2025-09-25_19h46_59.png" alt="Result summary screen example" style="width:100%; max-width:600px; margin-top:10px;">
            </li>
        </ol>

        <hr>

        <h2>4. Contents of the Downloaded File</h2>
        <p>The downloaded `analysis_results.zip` file contains six files. The first column of each CSV file indicates the original line number in the source file.</p>
        <ul>
            <li><strong>`only_in_File_A.csv`</strong>: List of rows that exist only in "File A".</li>
            <li><strong>`only_in_File_B.csv`</strong>: List of rows that exist only in "File B".</li>
            <li><strong>`in_both.csv`</strong>: List of rows common to both files.</li>
            <li><strong>`duplicates_in_File_A.csv`</strong>: List of rows that were duplicated within "File A".</li>
            <li><strong>`duplicates_in_File_B.csv`</strong>: List of rows that were duplicated within "File B".</li>
            <li><strong>`README.md`</strong>: A document explaining the contents of the five files above.</li>
        </ul>
    </div>

    <footer>
        <a href="index.html">Back to Tool</a> | &copy; 2024 konuma
    </footer>

</body>
</html>